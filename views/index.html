{% extends "base.html" %}

{% block hero %}
<div class="jumbotron jumbotron-home">
  <div class="background-blur">
    <div class="container">
      <h1>Ranking de portales de datos [beta]</h1>
      <p>
        Los portales de datos abiertos deben contener información fácil de reutilizar por parte de analistas, periodistas, organizaciones y ciudadanos. Evaluamos portales de gobiernos municipales, provinciales y organismos nacionales de los tres poderes del estado argentino.
      </p>
      <p>
        El puntaje de cada portal se calcula mensualmente de acuerdo a varios criterios detallados en nuestra <a href="/metodologia">metodología</a>.
      </p>

    </div>
    <ul class="overview row">
      <li class="counter col-lg-2 col-md-4 col-sm-12 col-lg-offset-2 col-md-offset-0">
        <span class="value">{{ ranking.portals_count }}</span>
        <span class="label">portales evaluados</span>
      </li>
      <li class="counter col-lg-3 col-md-4 col-sm-12 col-sm-">
        <span class="value">{{ ranking.datasets_count }}</span>
        <span class="label">conjuntos de datos</span>
      </li>
      <li class="counter col-lg-3 col-md-4 col-sm-12">
        <span class="value">{{ ranking.resources_count }}</span>
        <span class="label">recursos válidos</span>
      </li>
    </ul>
  </div>
</div>
{% endblock %}

{% block content %}
<section id="ranking">
  <div class="row">
    <h2>Los mejores portales de {{ ranking.updated_at | date("MMMM YYYY") }}</h2>
  </div>
  <div class="row">
    <table class="table table-condensed">
      <thead>
        <tr>
          <th class="text-center">Posición</th>
          <th class="text-center">Portal</th>
          <th class="text-center">Evaluación manual
            <a id="popover-manual" href="javascript:" class="popover-handle" data-toggle="popover" data-trigger="focus" data-placement="top" title="Evaluación manual" data-content="En algunos casos se evaluaron manualmente criterios adicionales. Ver <a href='/metodologia'>metodología</a>.">(?)</a>
          </th>
          <th class="text-center">
            Puntaje
            <a id="popover-calidad"  href="javascript:" class="popover-handle" data-toggle="popover" data-trigger="focus" data-placement="top" title="Nivel de Calidad" data-content="Se evalúan varios criterios sobre cada conjunto de datos. Ver <a href='/metodologia'>metodología</a>.">(?)</a>
          </th>
        </tr>
      </thead>
      <tbody>
        {% for portal in ranking.portals|sort(false,false,"current_position") %}
          <tr class="text-center">
            <td>{{portal.current_position}}
              {% if portal.current_position > portal.previous_position %}
              <span class="glyphicon glyphicon-menu-up text-success" title="Subió desde posición {{portal.previous_position}}"></span>
              {% elseif portal.current_position < portal.previous_position %}
              <span class="glyphicon glyphicon-menu-down text-danger"  title="Bajó desde posición {{portal.previous_position}}"></span>
              {% elseif portal.current_position == portal.previous_position %}
              <span class="equal-sign text-default" title="Mantiene posición">=</span>
              {% endif %}
            </td>
            <td><a href="/portals/{{portal.portal_slug}}">{{portal.portal_name}}</a></td>
            <td>
              {% if portal.has_manual_evaluation %}
              Si
              {% else %}
              No
              {% endif %}
            </td>
            <td>{{portal.score * 100}}%</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
    <p class="ranking_last_updated">
      Ranking mensual actualizado el: {{ ranking.updated_at | date("DD/MM/YYYY") }}
    </p>
  </div>
  <div class="row">

  </div>
</section>
{% endblock %}
