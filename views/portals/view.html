{% extends "base.html" %}

{% block title %}
  {{portal.title}} |
{% endblock %}

{% block hero %}
  <div class="jumbotron">
    <div class="container">

      <h1>
        {{portal.title}}
        {% if (currentUser.role === 'admin' or  currentUser.role === 'evaluator') and portal.to_evaluate === true %}
          <a class="btn btn-warning pull-right" href="/portals/evaluation/{{portal.slug}}" role="button">Evaluar <i class="fa fa-graduation-cap" aria-hidden="true"></i></a>
        {% endif %}
      </h1>
      <img style="float: left; margin: 0 2em 2em 0 " src="http://api.page2images.com/directlink?p2i_url=http://ckan.fcabierto.org&p2i_key=16631c3971d0f0b4&p2i_size=250x350" alt="Captura de pantalla del portal web" />
      <p style="font-size: 1.2em">Portal de datos CKAN</p>
      <p>
        {{ portal.description }}
      </p>
      <p>
        <a href="{{ portal.url }}" style="text-decoration: underline; color:white">{{ portal.url }}</a>
      </p>

      <ul style="clear: both;" class="row">
        <li class="counter col-md-2 col-sm-12 col-md-offset-2">
          <span class="value">1</span>
          <span class="label">Posición</span>
        </li>
        <li class="counter col-md-3 col-sm-12">
          <span class="value">89%</span>
          <span class="label">Puntaje</span>
        </li>
        <li class="counter col-md-3 col-sm-12">
          <span class="value">25</span>
          <span class="label">Conjuntos de datos</span>
        </li>
      </ul>
    </div>
  </div>
{% endblock %}
{% block content %}

  <div class="row" >
    <section class="line-chart col-md-12" >
      <h2>Historial de puntajes</h2>
      <canvas id="lineChart"  style="width: 100%; height: 300px;"></canvas>
      <script src="/js/Chart.min.js"></script>
      <script type="text/javascript">
        var ctx = document.getElementById("lineChart");
        var myChart = new Chart(ctx, {
          type: "line",
          data: {
            labels: ["10/02/2017", "17/02/2017", "24/02/2017"],
            datasets: [
              {
                label: "Puntaje total",
                data: [65, 59, 80],
                borderColor: "rgba(80,80,80,1)",
                backgroundColor: "rgba(80,80,80,1)",
                fill: false,
                borderWidth: 5
              },
              {
                label: "Navegación",
                data: [69, 49, 90],
                borderColor: "#5074D2",
                backgroundColor: "#5074D2",
                fill: false,
                borderWidth: 2
              },
              {
                label: "Uso automático",
                data: [12, 15, 15],
                borderColor: "#45BFA5",
                backgroundColor: "#45BFA5",
                fill: false,
                borderWidth: 2
              },
              {
                label: "Metadatos",
                data: [50, 80, 95],
                borderColor: "#BFBD3B",
                backgroundColor: "#BFBD3B",
                fill: false,
                borderWidth: 2
              },
              {
                label: "Datos",
                data: [69, 49, 10],
                borderColor: "#BF6E42",
                backgroundColor: "#BF6E42",
                fill: false,
                borderWidth: 2
              }

            ]
          }
        })


      </script>
    </section>
  </div>
  <div class="row">
    <div class="col-md-12">

      <h2>Evaluación por criterios</h2>
      Puntajes resumidos para cada uno de los criterios evaluados.

      <table class="score_summary">
        <thead>
          <tr>
            <th style="width: 30%">
              Criterio
            </th>
            <th>
              Puntaje
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              Puntaje total
            </td>
            <td>
              <div style="background-color: rgba(80,80,80,1); width: 90%">90%</div>
            </td>
          </tr>
          <tr>
            <td>
              Navegación
            </td>
            <td>
              <div style="background-color: #5074D2; width: 90%">90%</div>
            </td>
          </tr>
          <tr>
            <td>
              Uso automático
            </td>
            <td>
              <div style="background-color: #45BFA5; width: 80%">80%</div>
            </td>
          </tr>
          <tr>
            <td>
              Metadatos
            </td>
            <td>
              <div style="background-color: #BFBD3B; width: 100%">100%</div>
            </td>
          </tr>
          <tr>
            <td>
              Datos
            </td>
            <td>
              <div style="background-color: #BF6E42; width: 70%">70%</div>
              <!-- violetaa 9A63B6 -->
            </td>
          </tr>
        </tbody>
      </table>
      <p>
        Última actualización de puntaje: 22/02/2017
      </p>
    </div>
  </div>
  <div class="row">
    <h2>Detalles</h2>
    <div class="col-md-6">
      <div class="panel panel-info">
        <div class="panel-heading">Informe detallado</div>
        <div class="panel-body">
          <p>
            Solicite el informe detallado de errores en este portal de datos. Además del detalle de la evaluación automatizada de recurso, incluye una evaluación manual de la facilidad de uso del portal.
          </p>
          <p>
            <button type="button" class="btn btn-lg btn-info" name="button">Solcitar informe deallado</button>
            <a href="#">Ver ejemplo</a>
          </p>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <dl class="dl-horizontal">
          <dt>Autor:</dt>
          <dd>{{ portal.author }}</a></dd>
          <dt>URL:</dt>
          <dd><a href="{{ portal.url }}">{{ portal.url }}</a></dd>
          <dt>Estado:</dt>
          <dd>{{ portal.status }}</dd>
          <dt>Tipo de author:</dt>
          <dd>{{ portal.publisher_clasification }}</dd>
          <dt>País/Lenguaje:</dt>
          <dd>
            <span class="label label-info">{{ portal.country }}</span>
              /
            <span class="label label-info">{{ portal.lenguage }}</span>
          </dd>
          <dt>Plataforma utilizada</dt>
          <dd>{{ portal.plataform }}</dd>
          <dt>Tipo de API:</dt>
          <dd>{{ portal.api_type }}</dd>
          <dt>URL de API:</dt>
          <dd>{{ portal.api_endpoint }}</dd>
          <dt>Responsable del Portal</dt>
          <dd>
            {% if portal.owner %}
              {{ portal.owner }}
            {% else %}
            No asignado
            {% endif %}
          </dd>
          {% if currentUser.role === 'admin' %}
          <dt>Habilitado par evaluar:</dt>
          <dd>
            {% if portal.to_evaluate %}
            <span class="text-success">
              <i class="fa fa-check-circle" aria-hidden="true"></i>
            </span>
            {% else %}
            <span class="text-danger">
              <i class="fa fa-minus-circle" aria-hidden="true"></i>
            </span>
            {% endif %}
          </dd>
          {% endif %}
      </dl>
      {% if currentUser.role === 'admin' %}
      <div class="btn-inline">
        <a class="btn btn-primary" href="/portals/edit/{{portal.slug}}" role="button">Editar Portal</a>
        <form action="/portals/{{portal.slug}}" method="POST">
          <input type="hidden" name="_method" value="DELETE">
          <input type="hidden" name="_csrf" value="{{_csrf}}">
          <input type="submit" class="btn btn-danger" value="Borrar Portal">
        </form>
      </div>
      {% endif %}
    </div>
  </div>
{% endblock %}
